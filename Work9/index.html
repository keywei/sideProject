<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="CSS/normalize.css">
    <link rel="stylesheet" href="CSS/style.css">
</head>
<body>
    <div class="container">
        <div class="carousel">
            <div class="prev icon">&lt;</div>
            <div class="next icon">&gt;</div>
            <div class="images">
                <img class="img"  src="images/0.jpg">
                <img class="img"  src="images/1.jpg">
                <img class="img"  src="images/2.jpg">
                <img class="img"  src="images/3.jpg">
                <img class="img"  src="images/4.jpg">
            </div>
            <div class="btns"></div>
        </div>
        
    </div>
    <script>
        var current = 0;
        var carousel = document.getElementsByClassName('carousel')[0];
        var images = document.getElementsByClassName('images')[0];
        var btns = document.getElementsByClassName('btns')[0];
        var prev = document.getElementsByClassName('prev')[0];
        var next = document.getElementsByClassName('next')[0];
        var imagesWidth = images.children[0].offsetWidth;
        var timer = null;
        var addBtn = '';

        for (let i = 0;i < images.children.length;i++ ) {
            addBtn += '<a class = "btn" id = ' + i + '>' + parseInt(i + 1) + '</a>';
        }

        images.style.width = images.children.length * imagesWidth + 'px';
        btns.innerHTML = addBtn;

        for( let i = 0; i < btns.children.length; i++ ) {
            btns.children[i].addEventListener('click', function() {
                clickBtn(this.id);
            })
        }

        function clickBtn(id) {
            id = parseInt(id);
            let s;
            if((id === 0 && current === images.children.length - 1) ||
                (id === images.children.length - 1 && current === 0)) {
                    s = 10;
            } 
            current = id;
            move(id, s);
        }

        var moveTimer = null;
        function move(to, s) {
            to = parseInt(to)
            s = s || 30;
            clearInterval(moveTimer);
            indexbtn(to);
            let toDistance = to * -imagesWidth;
            moveTimer = setInterval(function() {
                let currentDistance = images.offsetLeft;
                let move = 40;
                move = currentDistance < toDistance ? move : -move;
                currentDistance += move;
                if (Math.abs(currentDistance - toDistance) > Math.abs(move)) {
                    images.style.left = currentDistance + 'px';
                } else {
                    clearInterval(moveTimer);
                    images.style.left = toDistance + 'px';
                  }
                }, s);
        }

        function indexbtn(index) {
            index = index || 0
            for(i of btns.children) {
                i.classList.contains('active') ? i.classList.remove('active') : '';
            }
            btns.children[index].classList.add('active');
        }
        indexbtn();

        prev.addEventListener('click', function() {
            let s;
            if(current === 0) {
                current = images.children.length - 1;
                s = 10;
            } else {
                current--;
              } 
            move(current, s);
        })

        next.addEventListener('click', function() {
            let s;
            if(current === images.children.length - 1) {
                current = 0;
                s = 10;
            } else {
                current++;
              }
            move(current, s);
        })
        
        function autoplay() {
            timer = setInterval(function() {
                let s;
                if(current === images.children.length - 1) {
                    current = 0
                    s = 10;
                    move(current, s);
                } else {
                    move(++current);
                }
            }, 2000);
        }
        autoplay();

        carousel.onmouseenter = function (){
            clearInterval(timer);
        }
        carousel.onmouseleave = function (){
            autoplay();
        }
    </script>
</body>